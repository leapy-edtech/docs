---
title: "Opera√ß√µes: Gerenciar Pulsos (CS/Ops)"
description: "Guia operacional para Customer Success e Opera√ß√µes"
---

## Vis√£o Geral

Este guia √© para **CS (Customer Success)** e **Opera√ß√µes** que precisam realizar tarefas operacionais avan√ßadas no sistema de Pulsos via Directus (Backoffice).

<Warning>
  Este guia assume conhecimento t√©cnico intermedi√°rio. Se voc√™ n√£o tem acesso ao Backoffice, consulte o [guia do App RH](/guides/app-rh/pulsos-quickstart-rh).
</Warning>

---

## Acessar Collections no Directus

### URL do Backoffice

```
https://backoffice.leapy.com/admin
```

### Collections de Pulsos

| Collection | Descri√ß√£o | Uso frequente |
|------------|-----------|---------------|
| `pulsos_jovens` | Respostas dos talentos | Editar, exportar, corrigir |
| `Pulsos` | Avalia√ß√µes de lideran√ßas | Editar, exportar |
| `pulsos_rh` | Respostas do RH | Editar, exportar |
| `pulsos_settings` | Configura√ß√£o de perguntas | Habilitar/desabilitar perguntas |
| `pulsos_schedule_settings` | Agendamento autom√°tico | Ajustar cad√™ncia |
| `pulsos_paramentros` | Par√¢metros globais | Raramente alterado |

---

## Criar Pulso Manualmente

### Quando usar

Use cria√ß√£o manual apenas quando:

- ‚úÖ Talento entrou ap√≥s a cria√ß√£o autom√°tica
- ‚úÖ Pulso foi deletado por erro
- ‚úÖ Teste de funcionalidade

<Warning>
  Evite cria√ß√£o manual em massa. Prefira ajustar o agendamento autom√°tico.
</Warning>

### Como criar

<Steps>
  <Step title="Acessar Collection">
    No Directus, v√° em **Collections > pulsos_jovens**
  </Step>
  
  <Step title="Clicar em Create Item">
    Bot√£o **"+"** no canto superior direito
  </Step>
  
  <Step title="Preencher Campos Obrigat√≥rios">
    ```json
    {
      "jovem_id": 789,
      "pulso": 3,
      "status": "pendente",
      "data_aplicacao": "2024-03-01T09:00:00Z",
      "data_vencimento": "2024-03-08T23:59:59Z"
    }
    ```
  </Step>
  
  <Step title="Salvar">
    O sistema disparar√° evento para enviar notifica√ß√£o
  </Step>
</Steps>

### Valida√ß√µes Importantes

- `jovem_id` deve existir na tabela `talents`
- `pulso` deve ser entre 1-5
- `data_vencimento` deve ser posterior a `data_aplicacao`
- `status` inicial: `agendado` ou `pendente`

---

## Editar Pulsos em Lote

### Estender Prazo para Grupo

**Cen√°rio:** Feriado prolongado, todos precisam de +5 dias

<Steps>
  <Step title="Filtrar Pulsos">
    Em **pulsos_jovens**, use filtros:
    - `status` = `vencido`
    - `data_vencimento` > `$NOW(-7d)` (vencidos h√° menos de 7 dias)
  </Step>
  
  <Step title="Selecionar Todos">
    Checkbox no topo da tabela
  </Step>
  
  <Step title="Editar em Lote">
    Bot√£o **"Edit Selected"** (√≠cone de l√°pis)
  </Step>
  
  <Step title="Atualizar Campos">
    - `status`: `pendente`
    - `data_vencimento`: nova data (+5 dias)
  </Step>
  
  <Step title="Salvar">
    Sistema enviar√° notifica√ß√µes automaticamente
  </Step>
</Steps>

### Via API REST

Para automa√ß√£o, use a API:

```bash
# Atualizar m√∫ltiplos pulsos
curl -X PATCH "https://backoffice.leapy.com/items/pulsos_jovens?filter[status][_eq]=vencido" \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "pendente",
    "data_vencimento": "2024-03-15T23:59:59Z"
  }'
```

---

## Disparar Jobs Manualmente

### Via Inngest Dashboard

**URL:** https://app.inngest.com

#### Jobs Dispon√≠veis

| Job | ID | Quando usar |
|-----|----|-------------|
| Criar Pulsos Jovens | `createPulsosJovens` | For√ßar cria√ß√£o fora da data |
| Atualizar Status | `updateStatusPulsosJovensParaPendentes` | Liberar pulsos agendados |
| Enviar Lembretes | `sendPulsosLembretetoJovens` | Reenviar notifica√ß√µes |
| Processar Pulsos | `processaPulsosJovensOuLiderancas` | Reprocessar l√≥gica |

#### Como Disparar

1. Acesse Inngest Dashboard
2. V√° em **Functions**
3. Encontre o job desejado
4. Clique em **"Trigger with Custom Event"**
5. Preencha o payload:

```json
{
  "name": "backoffice/pulsos_jovens/lembrete-to-jovens.send",
  "data": {
    "pulso_ids": [12345, 12346, 12347]
  }
}
```

6. Clique em **"Send Event"**
7. Monitore execu√ß√£o na aba **"Runs"**

<Tip>
  Sempre teste com 1-2 pulsos antes de disparar em massa.
</Tip>

---

## Exportar Dados para An√°lise

### Via Interface do Directus

1. V√° na collection desejada
2. Aplique filtros se necess√°rio
3. Clique em **"Export"** (√≠cone de download)
4. Escolha formato: **CSV** ou **JSON**
5. Download inicia automaticamente

### Via API para Automa√ß√£o

```bash
# Exportar todos os pulsos respondidos
curl -X GET "https://backoffice.leapy.com/items/pulsos_jovens?filter[status][_eq]=respondido&fields=*&limit=-1&export=json" \
  -H "Authorization: Bearer TOKEN" \
  -o pulsos_respondidos.json
```

### SQL Direto (Supabase)

Para an√°lises complexas, use o editor SQL:

```sql
-- Taxa de resposta por √°rea
SELECT 
  t.area_id,
  COUNT(*) as total_pulsos,
  SUM(CASE WHEN pj.status = 'respondido' THEN 1 ELSE 0 END) as respondidos,
  ROUND(
    SUM(CASE WHEN pj.status = 'respondido' THEN 1 ELSE 0 END)::numeric / COUNT(*)::numeric * 100,
    2
  ) as taxa_resposta
FROM pulsos_jovens pj
JOIN talents t ON pj.jovem_id = t.id
WHERE pj.pulso = 3
GROUP BY t.area_id
ORDER BY taxa_resposta DESC;
```

---

## Corrigir Inconsist√™ncias

### Pulsos Duplicados

**Identificar:**

```sql
SELECT jovem_id, pulso, COUNT(*)
FROM pulsos_jovens
GROUP BY jovem_id, pulso
HAVING COUNT(*) > 1;
```

**Corrigir:**

1. Identifique qual √© o correto (mais recente, com respostas, etc)
2. Delete os duplicados manualmente
3. Investigue causa (job rodou 2x? cria√ß√£o manual?)

### Status Inconsistente

**Cen√°rio:** Pulso est√° "pendente" mas prazo venceu

**Corrigir em lote:**

```sql
UPDATE pulsos_jovens
SET status = 'vencido'
WHERE status = 'pendente'
  AND data_vencimento < NOW();
```

### Pulso sem Notifica√ß√£o

Se pulso foi criado mas notifica√ß√£o n√£o foi enviada:

1. Verifique se evento foi disparado (logs do Inngest)
2. Reenvie manualmente via job `sendPulsosLembretetoJovens`
3. Confira se email do talento est√° correto

---

## Monitorar Sa√∫de do Sistema

### M√©tricas Cr√≠ticas

Monitore diariamente:

<CardGroup cols={2}>
  <Card title="Taxa de Cria√ß√£o" icon="plus">
    Pulsos criados na data esperada?
  </Card>
  <Card title="Taxa de Entrega" icon="envelope">
    Emails sendo enviados com sucesso?
  </Card>
  <Card title="Taxa de Resposta" icon="check">
    % de pulsos respondidos por empresa
  </Card>
  <Card title="Jobs Falhados" icon="x">
    Erros no Inngest?
  </Card>
</CardGroup>

### Dashboard do Inngest

Acesse diariamente para verificar:

- ‚úÖ **Success Rate**: Deve estar > 95%
- ‚è±Ô∏è **Latency**: M√©dio < 5s
- üîÑ **Retry Rate**: Deve estar < 5%
- ‚ùå **Failed Jobs**: Investigar imediatamente

### Alertas Autom√°ticos

Configure alertas no Inngest:

- Taxa de erro > 10%
- Job n√£o executou na √∫ltima 24h
- Lat√™ncia m√©dia > 30s

---

## Troubleshooting R√°pido

### Pulso n√£o foi criado

1. **Verifique agendamento**: `pulsos_schedule_settings` est√° `enabled: true`?
2. **Confira data**: `next_pulso_date` est√° correto?
3. **Veja logs**: Inngest > Function `createPulsosJovens` > Runs
4. **Valide talentos**: H√° talentos ativos no sistema?

### Notifica√ß√£o n√£o enviada

1. **Verifique Resend**: Dashboard do Resend mostra envio?
2. **Confira template**: Email template existe e est√° ativo?
3. **Valide email**: Email do destinat√°rio est√° correto?
4. **Veja logs**: Inngest > Function `sendPulsosLembretetoJovens`

### Job travado

1. **Verifique status**: Inngest > Runs > Status = "Running"?
2. **Tempo de execu√ß√£o**: Se > 5min, pode estar travado
3. **Cancele manualmente**: Bot√£o "Cancel" no Inngest
4. **Re-execute**: Trigger novamente com mesmo payload

Para mais detalhes, consulte [Troubleshooting T√©cnico](/guides/backoffice/pulsos-troubleshooting).

---

## Boas Pr√°ticas

### Backup Antes de Edi√ß√µes em Massa

Sempre exporte dados antes de editar em lote:

```bash
# Backup
curl -X GET "https://backoffice.leapy.com/items/pulsos_jovens?limit=-1" \
  -H "Authorization: Bearer TOKEN" \
  > backup_pulsos_$(date +%Y%m%d).json
```

### Testar em Staging

Para mudan√ßas cr√≠ticas:

1. Teste primeiro em ambiente de staging
2. Valide com 1-2 pulsos de teste
3. Apenas depois aplique em produ√ß√£o

### Documentar Mudan√ßas

Mantenha log de opera√ß√µes:

```markdown
## 2024-03-15 - Extens√£o de prazo

- **Motivo**: Feriado prolongado
- **Pulsos afetados**: 45 (IDs: 12300-12345)
- **A√ß√£o**: data_vencimento de 08/03 ‚Üí 15/03
- **Operador**: Jo√£o CS
```

---

## Pr√≥ximos Passos

<CardGroup cols={2}>
  <Card title="Troubleshooting T√©cnico" icon="wrench" href="/guides/backoffice/pulsos-troubleshooting">
    Resolver problemas t√©cnicos
  </Card>
  <Card title="API Reference" icon="code" href="/api-reference/backoffice/pulsos-jovens">
    Documenta√ß√£o completa da API
  </Card>
  <Card title="Jobs Inngest" icon="gear" href="/documentation/domains/pulses/jobs-inngest">
    Detalhes dos jobs autom√°ticos
  </Card>
  <Card title="Modelo de Dados" icon="database" href="/documentation/domains/pulses/data-model">
    Estrutura t√©cnica
  </Card>
</CardGroup>
